generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearch", "fullTextIndex"]
}

datasource db {
  provider          = "postgresql"
  url               = env("POSTGRES_PRISMA_URL")
  directUrl         = env("POSTGRES_URL_NON_POOLING")
  shadowDatabaseUrl = env("POSTGRES_URL_NON_POOLING")
}

model Video {
  id            String         @id @unique @map("id")
  isSenate      Boolean        @default(false) @map("is_senate")
  happenedAt    DateTime       @map("happened_at")
  transcription Transcription?

  @@map("videos")
}

model Transcription {
  videoId  String                 @id @unique @map("video_id")
  segments TranscriptionSegment[]
  resume   String                 @db.Text()
  video    Video                  @relation(fields: [videoId], references: [id])

  @@map("transcriptions")
}

model TranscriptionSegment {
  id              String                 @id @unique @map("id")
  transcriptionId String                 @map("transcription_id")
  startAt         String                 @map("start_at")
  endAt           String                 @map("end_at")
  content         String                 @db.Text
  transcription   Transcription          @relation(fields: [transcriptionId], references: [videoId])
  vector          Unsupported("vector")?

  @@unique([transcriptionId, startAt, endAt, content])
  @@index([transcriptionId])
  @@map("transcription_segments")
}
